PASCOMP,T0.
RFL(120000)
REDUCE.
COMMENT.*
COMMENT.*  ----------------------------  *
COMMENT.*  CONSTRUCT THE PASCAL SYSTEM.  *
COMMENT.*  ----------------------------  *
COMMENT.*
COMMENT.*
COMMENT.*  INPUT FILES REQUIRED FOR PASCOMP.
COMMENT.*       NAME      DESCRIPTION
COMMENT.*       OLDPASC   OLD PASCAL COMPILER BINARY.
COMMENT.*       OLDPLIB   OLD PASCAL LIBRARY BINARY.
COMMENT.*       PSRCLIB   ERROR TEXTS.
COMMENT.*       COLDPL    OLD PASCAL COMPILER OLDPL.
COMMENT.*       LOLDPL    OLD PASCAL EXTENDED LIBRARY OLDPL.
COMMENT.*  OBTAIN PASCAL[0] AND PASCLIB[0] AS OLDPASC AND OLDPLIB.
COMMENT.*
ATTACH(COLDPL,ID=PASCAL4,PW=A)
ATTACH(LOLDPL,ID=PASCAL4,PW=A)
ATTACH(PASCAL,ID=PASCAL4)
ATTACH(PASCLIB,ID=PASCAL4)
ATTACH(PSRCLIB,ID=PASCAL4)
COMMENT.*
COMMENT.*
COMMENT.*  OUTPUT FILES CREATED BY PASCOMP.
COMMENT.*       NAME      DESCRIPTION
COMMENT.*       PASCAL    NEW PASCAL COMPILER BINARY.
COMMENT.*       PASCLIB   NEW PASCAL LIBRARY BINARY.
COMMENT.*       PSRCLIB   NEW PASCAL SOURCE LIBRARY.
COMMENT.*       CNEWPL    NEW PASCAL COMPILER OLDPL.
COMMENT.*       LNEWPL    NEW PASCAL EXTENDED LIBRARY OLDPL.
COMMENT.*       INCLGEN   INCLGEN PROGRAM ABSOLUTE BINARY.
COMMENT.*       PASHIST   COLDPL HISTORY DECK.
COMMENT.*       LIBHIST   LOLDPL HISTORY DECK.
COMMENT.*       PASTEXT   PASCAL SYSTEMS TEXT.
COMMENT.*
COMMENT.*
COMMENT.*
COMMENT.*  PREPARE NEW COMPILER AND LIBRARY.
COMMENT.*
COMMENT.*
COMMENT.*
COMMENT.*  APPLY FIRST MODS.
COMMENT.*
UPDATE(F,L=1,N=NEWPL,P=COLDPL)
COMMENT.*
COMMENT.*
COMMENT.*  SKIP HISTORY DECK.
COMMENT.*
SKIPF(COMPILE,1)
COMMENT.*
COMMENT.*
COMMENT.*  PREPARE ERROR TEXT PROCESSOR.
COMMENT.*
REWIND(LGO)
PASCAL(I,L=0,PL)
REWIND(LGO)
REWIND(INCLGEN)
LOAD(LGO)
NOGO(INCLGEN)
COMMENT.*
COMMENT.*
COMMENT.*  ASSEMBLE PASCAL-6000 SYSTEM TEXT[1].
COMMENT.*
REWIND(PASTEXT)
COMPASS(A,B=PASTEXT,I,L=0)
COMMENT.*
COMMENT.*
COMMENT.*  CREATE PASCAL[1].
COMMENT.*
REWIND(LGO)
COMPASS(A,I,L=A,G=PASTEXT,S=CPUTEXT,S=PFMTEXT)
PASCAL(I,L=0,PL)
REWIND(LGO)
REWIND(PASCAL)
COMMENT.*
COMMENT.*  REQUEST NEW COMPILER.
COMMENT.*
RETURN(PASCAL)
REQUEST(PASCAL,*PF,SN)
LOAD(LGO)
NOGO(PASCAL)
COMMENT.*
COMMENT.*
COMMENT.*  CREATE MINIMAL PASCLIB[1].
COMMENT.*
REWIND(LGO)
REWIND(TEMP)
COPYBR(COMPILE,TEMP)
REWIND(TEMP)
COMMENT.*
COMMENT.*  REQUEST NEW SOURCE LIBRARY.
COMMENT.*
RETURN(PSRCLIB)
REQUEST(PSRCLIB,*PF,SN)
INCLGEN(TEMP,PSRCLIB)
COMPASS(A,I,L=0,G=PASTEXT,S=CPUTEXT,S=PFMTEXT,S=IPTEXT)
PASCAL(I,L=0,PL)
BKSP(LGO,2)
COMPASS(A,I,L=0,G=PASTEXT,S=CPUTEXT,S=PFMTEXT,S=IPTEXT)
REWIND(LGO)
REWIND(PASCLIB)
COMMENT.*
COMMENT.*  REQUEST NEW LIBRARY.
COMMENT.*
RETURN(PASCLIB)
REQUEST(PASCLIB,*PF,SN)
EDITLIB(USER)
COMMENT.*
COMMENT.*
COMMENT.*
COMMENT.*  NOW DO IT AGAIN TO COMPLETE
COMMENT.*  A FULL BOOTSTRAP.
COMMENT.*
COMMENT.*
COMMENT.*
COMMENT.*  APPLY SECOND MODS.
COMMENT.*
REQUEST(CNEWPL,*PF,SN)
UPDATE(F,L=1,N=CNEWPL,P=NEWPL)
COMMENT.*
COMMENT.*
COMMENT.*  COPY HISTORY DECK.
COMMENT.*
REWIND(PASHIST)
COPYBR(COMPILE,PASHIST)
COMMENT.*
COMMENT.*
COMMENT.*  SKIP ERROR TEXT PROCESSOR.
COMMENT.*
SKIPF(COMPILE,1)
COMMENT.*
COMMENT.*
COMMENT.*  ASSEMBLE PASCAL-6000 SYSTEM TEXT[2].
COMMENT.*
REWIND(PASTEXT)
COMPASS(A,B=PASTEXT,I,L=0)
COMMENT.*
COMMENT.*
COMMENT.*  CREATE PASCAL[2].
COMMENT.*
REWIND(LGO)
COMPASS(A,I,L=0,G=PASTEXT,S=CPUTEXT,S=PFMTEXT)
PASCAL(I,L=0,PL)
REWIND(LGO)
REWIND(PASCAL)
LOAD(LGO)
NOGO(PASCAL)
COMMENT.*
COMMENT.*
COMMENT.*  CREATE MINIMAL PASCLIB[2].
COMMENT.*
REWIND(LGO)
REWIND(TEMP)
COPYBR(COMPILE,TEMP)
REWIND(TEMP)
REWIND(PSRCLIB)
INCLGEN(TEMP,PSRCLIB)
COMPASS(A,I,L=0,G=PASTEXT,S=CPUTEXT,S=PFMTEXT,S=IPTEXT)
PASCAL(I,L=0,PL)
BKSP(LGO,2)
COMPASS(A,I,L=0,G=PASTEXT,S=CPUTEXT,S=PFMTEXT,S=IPTEXT)
REWIND(LGO)
REWIND(PASCLIB)
EDITLIB(USER)
COMMENT.*
COMMENT.*
COMMENT.*
COMMENT.*  GENERATE FULL PASCAL LIBRARY.
COMMENT.*
COMMENT.*
COMMENT.*
COMMENT.*  APPLY LIBRARY MODS.
COMMENT.*
REQUEST(LNEWPL,*PF,SN)
UPDATE(F,L=1,N=LNEWPL,P=LOLDPL)
COMMENT.*
COMMENT.*
COMMENT.*  COPY HISTORY DECK.
COMMENT.*
REWIND(LIBHIST)
COPYBR(COMPILE,LIBHIST)
COMMENT.*
COMMENT.*
COMMENT.*  PROCESS INCLUDE DECKS.
COMMENT.*
REWIND(LGO)
REWIND(TEMP)
COPYBR(COMPILE,TEMP)
REWIND(TEMP)
INCLGEN(TEMP,PSRCLIB)
COMMENT.*
COMMENT.*
COMMENT.*  COPY MINIMAL PASCLIB[2] RECORDS.
COMMENT.*
COMMENT.*
COMMENT.*
COMMENT.*  ADD LIBRARY ROUTINES.
COMMENT.*
PASCAL(I,L=0,PL)
BKSP(LGO,2)
PASCAL(I,L=0,PL)
BKSP(LGO)
REWIND(TEMP)
COPYBR(LGO,TEMP)
BKSP(LGO,2)
REWIND(TEMP)
COPYBR(TEMP,LGO)
COMPASS(A,I,L=0,G=PASTEXT,S=CPUTEXT,S=PFMTEXT)
REWIND(LGO)
REWIND(PASCLIB)
EDITLIB(USER)
COMMENT.*
COMMENT.*
COMMENT.*  UPDATE FILES.
COMMENT.*
CATALOG(INCLGEN,ID=PASCAL4,TK=A,PW=A)
CATALOG(PASTEXT,ID=PASCAL4,TK=A,PW=A)
CATALOG(PASHIST,ID=PASCAL4,XR=A,PW=A)
CATALOG(LIBHIST,ID=PASCAL4,XR=A,PW=A)
CATALOG(PASCAL,ID=PASCAL4,XR=A,PW=A)
CATALOG(PASCLIB,ID=PASCAL4,XR=A,PW=A)
CATALOG(PSRCLIB,ID=PASCAL4,XR=A,PW=A)
COMMENT.
COMMENT. *** PASCOMP COMPLETE ***
EXIT(S)
COMMENT. *** PASCOMP FAILED ***
COMMENT.*
~00
*/
*/  MODS FOR FIRST COMPILATION GO HERE.
*/
~00
LIBRARY(PASCLIB,NEW)
ADD(*,LGO)
FINISH.
ENDRUN.
~00
*/
*/  MODS FOR SECOND COMPILATION GO HERE.
*/
~00
LIBRARY(PASCLIB,OLD)
REPLACE(*,LGO)
FINISH.
ENDRUN.
~00
*/
*/  MODS FOR LIBRARY COMPILATION GO HERE.
*/
~00
LIBRARY(PASCLIB,OLD)
REPLACE(*,LGO)
FINISH.
ENDRUN.
~00
}

